---
title: DNS Server
author: Yeongjune Joe
date: 2023-11-12
category: DNS Server
layout: post
mermaid: true
---


# Depolying Linux DNS Server

Oracle Server8 에 DNS 서버를 구축 해서 운영 하기.

### 1. Installing bind package
Bind 란?
BIND는(Berkeley Internet Name Domain)의 약자로, DNS를 운용하기 위한 데몬 프로그램으로서 Unix 계열의 OS에서 사용되도록 구현된 프로그램 입니다.
```
$ sudo dnf install bind bind-chroot bind-utils
```

### 2. named.conf settings

```
$ sudo vim /etc/named.conf

  listen-on port 53 { any; };   //Modify
  allow-query { any; };         //Modify
  masterfile-format text;       //Addition
```
![image](https://github.com/joeyeongjune/joeyeongjune.github.io/assets/42788315/f90f1aea-a41b-4543-b9dd-b7a3942f78e0)

### 3. named.conf validation check

```
$ sudo named-checkconf /etc/named.conf
```
If there is no output, there is no problem

### 4. Add domain zone information

```
$ sudo vim /etc/named.rfc1912.zones

・・・
zone "tickle.com" IN {
        type master;
        file "tickle.com.zone";
        allow-update { none; };
};
```

### 5. Create zone files and change permissions

```
$ sudo ls -l /var/named/named.localhost
  -rw-r-----. 1 root named 152 Oct  7 02:51 /var/named/named.localhost

$ sudo cp -p /var/named/named.localhost /var/named/tickle.com.zone
$ sudo ls -l /var/named/tickle.oracle8.zone
  -rw-r-----. 1 root named 152 Oct  7 02:51 /var/named/tickle.com.zone
```

### 6. zone file record modification

```
$ sudo vim /var/named/tickle.com.zone

$TTL 1D
@       IN SOA  tickle.com. root.(
                          0       ; serial
                          1D      ; refresh
                          1H      ; retry
                          1W      ; expire
                          3H )    ; minimum
        IN NS   tickle.com.
        IN A    192.168.0.200
www     IN A    192.168.0.200
```

### 7. zone file settings and zone file validation check

```
$ sudo named-checkconf /etc/named.rfc1912.zones
  If there is no output, there is no problem

$ sudo named-checkzone tickle.com /var/named/tickle.com.zone
  zone tickle.com/IN: loaded serial 0
  OK
```

### 8. /etc/resolv.conf DNS 127.0.0.1 registration

```
$ sudo ls -l /etc/resolv.conf
  -rw-r--r--. 1 root root 82 Oct 16 16:50 /etc/resolv.conf
$ sudo cp -p /etc/resolv.conf /etc/resolv.conf.back
$ sudo vim /etc/resolv.conf
  # Generated by NetworkManager
  nameserver 127.0.0.1
  nameserver 58.159.201.244
  nameserver 61.122.116.174
```

![image](https://github.com/joeyeongjune/joeyeongjune.github.io/assets/42788315/60ab6398-fa6b-4e21-ad0a-56bd8925670c)

```
$ nmcli device
  DEVICE   TYPE      STATE      CONNECTION
  enp0s25  ethernet  connected  enp0s25
  lo       loopback  unmanaged  --
  wlo1     wifi      unmanaged  --

$ sudo nmcli con up enp0s25
  Connection successfully activated (D-Bus active path: /org/freedesktop/NetworkManager/ActiveConnection/2)
```

### 9. Named service restart and service auto-excution registration

```
$ sudo systemctl restart named
$ sudo systemctl enable named
  Created symlink /etc/systemd/system/multi-user.target.wants/named.service → /usr/lib/systemd/system/named.service.
```

### 10. Verify Registered Domain and IP

```
$ nslookup
  > tickle.com
  Server:         127.0.0.1
  Address:        127.0.0.1#53

  Name:   tickle.com
  Address: 192.168.0.200
```

### Issues

- [resolv.conf 초기화 현상](https://it-serial.tistory.com/entry/%EB%A6%AC%EB%88%85%EC%8A%A4-DNS-%EC%84%A4%EC%A0%95-%EB%B2%88%EC%99%B8%ED%8E%B8-resolvconf-%ED%8C%8C%EC%9D%BC%EC%B4%88%EA%B8%B0%ED%99%94-%ED%98%84%EC%83%81-%EC%84%A4%EB%AA%85)